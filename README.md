# Wishlist Tracker

A Rails application for tracking wish list purchases with intelligent fund allocation based on income patterns and priorities.

## Features

- **User Authentication**: Secure registration and login using Devise
- **Three Types of Wish List Items**:
  - **Target Date**: Items you want to purchase by a specific date
  - **Sequential**: Items prioritized in a specific order (1st, 2nd, 3rd, etc.)
  - **Percentage-Based**: Items allocated funds by percentage priority
- **Income Tracking**: Track recurring income with multiple patterns:
  - Specific date each month (e.g., 15th)
  - Last day of month
  - Biweekly (every 2 weeks)
- **Expense Management**: Track one-off expenses that reduce available funds
- **Smart Allocation Algorithm**: Automatically calculates how your future income should be allocated:
  1. First ensures target date items are funded
  2. Then funds sequential items in order
  3. Finally distributes remaining funds by percentage
- **Timeline View**: Visual representation of when each item will be fully funded
- **Purchase History**: Track completed purchases

## Tech Stack

- Ruby on Rails 8.0
- PostgreSQL
- Tailwind CSS
- Devise for authentication
- Hotwire (Turbo + Stimulus)

## Local Development

### Prerequisites

- Ruby 3.4+
- PostgreSQL
- Node.js (for Tailwind CSS)

### Setup

1. Clone the repository
2. Install dependencies:
   ```bash
   bundle install
   ```

3. Set up the database:
   ```bash
   rails db:create db:migrate db:seed
   ```

4. Start the development server:
   ```bash
   bin/dev
   ```

5. Visit http://localhost:3000
6. Login with demo credentials:
   - Email: demo@example.com
   - Password: password

## Deployment to Railway

### Prerequisites

- Railway account
- Railway CLI (optional)

### Steps

1. Create a new project on Railway
2. Add a PostgreSQL database to your project
3. Connect your GitHub repository or use Railway CLI:
   ```bash
   railway link
   railway up
   ```

4. Set environment variables in Railway:
   - `RAILS_MASTER_KEY`: Copy from `config/master.key`
   - `DATABASE_URL`: Automatically set by Railway PostgreSQL

5. Deploy:
   - Railway will automatically detect the Rails app
   - It will run migrations via the `Procfile` release command
   - The app will be available at your Railway URL

### Manual Deployment Steps

If deploying manually:

1. Ensure your `database.yml` is configured to use `DATABASE_URL` in production
2. Ensure `Procfile` exists with:
   ```
   web: bundle exec puma -C config/puma.rb
   release: bundle exec rails db:migrate
   ```

3. Push to Railway or your preferred platform

## Environment Variables

Required for production:
- `DATABASE_URL`: PostgreSQL connection string
- `RAILS_MASTER_KEY`: Rails credentials encryption key
- `SECRET_KEY_BASE`: Automatically generated by Rails

## Database Configuration

The app uses:
- PostgreSQL for all environments (development, test, production)
- Credentials: `postgres/password` for local development (configurable in `config/database.yml`)

## How It Works

### Allocation Algorithm

The allocation calculator (`app/services/allocation_calculator.rb`) works as follows:

1. **Gather Income**: Collects all future income occurrences based on your income sources
2. **Subtract Expenses**: Removes future one-off expenses from available funds
3. **Allocate for Target Date Items**: Ensures items with specific target dates are funded by distributing income up to that date
4. **Sequential Allocation**: Uses remaining funds to fund sequential items in priority order
5. **Percentage Allocation**: Distributes any remaining funds according to percentage priorities

Example:
- Income: $300 on 15th, $300 on last day of month, $150 biweekly
- Target: $1000 desk by March 31, 2026
- Sequential: $500 chair (1st), $200 mat (2nd)
- Percentage: $800 smoker (80%), $200 keyboard (20%)
- Expense: $150 car insurance next month

The algorithm will:
1. Reserve funds to hit the $1000 desk by March 31, 2026
2. Use remaining funds (after expenses) to fund the chair first, then the mat
3. Distribute any leftover funds 80% to smoker, 20% to keyboard

## Contributing

This is a personal project, but suggestions and improvements are welcome!

## License

MIT
